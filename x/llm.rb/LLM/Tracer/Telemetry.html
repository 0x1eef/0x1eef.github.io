<!DOCTYPE html>
<HTML>
<HEAD>
  <META name="generator" content=
  "HTML Tidy for HTML5 for FreeBSD version 5.8.0">
  <META charset="utf-8">
  <META name="viewport" content="width=device-width, initial-scale=1.0">
  <TITLE>Class: LLM::Tracer::Telemetry — Documentation by YARD 0.9.36</TITLE>
  <LINK rel="stylesheet" href="../../css/style.css" type="text/css">
  <LINK rel="stylesheet" href="../../css/common.css" type="text/css">
  <LINK rel="stylesheet" href="../../css/main.css" type="text/css">
  <LINK rel="stylesheet" href="../../css/rouge.css" type="text/css">
  <SCRIPT type="text/javascript">
  pathId = "LLM::Tracer::Telemetry";
  relpath = '../../';
  </SCRIPT>
  <SCRIPT type="text/javascript" charset="utf-8" src=
  "../../js/jquery.js"></SCRIPT>
  <SCRIPT type="text/javascript" charset="utf-8" src=
  "../../js/app.js"></SCRIPT>
</HEAD>
<BODY>
  <DIV class="nav_wrap">
    <IFRAME id="nav" src="../../class_list.html?1" name="nav"></IFRAME>
    <DIV id="resizer"></DIV>
  </DIV>
  <DIV id="main" tabindex="-1">
    <DIV id="header">
      <DIV id="menu">
        <A href="../../_index.html">Index (T)</A> » <SPAN class=
        'title'><SPAN class='object_link'><A href="../../LLM.html" title=
        "LLM (module)">LLM</A></SPAN></SPAN> » <SPAN class='title'><SPAN class=
        'object_link'><A href="../Tracer.html" title=
        "LLM::Tracer (class)">Tracer</A></SPAN></SPAN> » <SPAN class=
        "title">Telemetry</SPAN>
      </DIV>
      <DIV id="search">
        <A class="full_list_link" id="class_list_link" href=
        "../../class_list.html"><SVG width="24" height="24">
        <RECT x="0" y="4" width="24" height="4" rx="1" ry="1"></RECT>
        <RECT x="0" y="12" width="24" height="4" rx="1" ry="1"></RECT>
        <RECT x="0" y="20" width="24" height="4" rx="1" ry="1">
        </RECT></SVG></A>
      </DIV>
      <DIV class="clear"></DIV>
    </DIV>
    <DIV id="content">
      <H1>Class: LLM::Tracer::Telemetry</H1>
      <DIV class="box_info">
        <DL>
          <DT>Inherits:</DT>
          <DD>
            <SPAN class="inheritName"><SPAN class='object_link'><A href=
            "../Tracer.html" title=
            "LLM::Tracer (class)">LLM::Tracer</A></SPAN></SPAN>
            <UL class="fullTree">
              <LI>Object</LI>
              <LI class="next"><SPAN class='object_link'><A href=
              "../Tracer.html" title=
              "LLM::Tracer (class)">LLM::Tracer</A></SPAN></LI>
              <LI class="next">LLM::Tracer::Telemetry</LI>
            </UL><A href="#" class="inheritanceTree">show all</A>
          </DD>
        </DL>
        <DL>
          <DT>Defined in:</DT>
          <DD>lib/llm/tracer/telemetry.rb</DD>
        </DL>
      </DIV>
      <H2>Overview</H2>
      <DIV class="docstring">
        <DIV class="discussion">
          <P>The <SPAN class='object_link'><A href="" title=
          "LLM::Tracer::Telemetry (class)">LLM::Tracer::Telemetry</A></SPAN>
          tracer provides telemetry support through the <A href=
          "https://github.com/open-telemetry/opentelemetry-ruby">opentelemetry-ruby</A>
          RubyGem. The gem should be installed separately since this feature is
          opt-in and disabled by default. This feature exists to support
          integration with tools like <A href=
          "https://www.langsmith.com">LangSmith</A>.</P>
        </DIV>
      </DIV>
      <DIV class="tags">
        <DIV class="examples">
          <P class="tag_title">Examples:</P>
          <P class="example_title"></P>
          <DIV class='inline'>
            <P>InMemory export</P>
          </DIV>
          <PRE class="example code"><CODE><SPAN class=
          'comment'>#!/usr/bin/env ruby
</SPAN><SPAN class='id identifier rubyid_require'>require</SPAN> <SPAN class=
'tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>llm</SPAN><SPAN class='tstring_end'>"</SPAN></SPAN>
<SPAN class='id identifier rubyid_require'>require</SPAN> <SPAN class=
'tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>pp</SPAN><SPAN class='tstring_end'>"</SPAN></SPAN>

<SPAN class='id identifier rubyid_llm'>llm</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='const'><SPAN class='object_link'><A href=
"../../LLM.html" title="LLM (module)">LLM</A></SPAN></SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_openai'><SPAN class=
'object_link'><A href="../../LLM.html#openai-class_method" title=
"LLM.openai (method)">openai</A></SPAN></SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>key:</SPAN> <SPAN class=
'const'>ENV</SPAN><SPAN class='lbracket'>[</SPAN><SPAN class=
'tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>KEY</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='rbracket'>]</SPAN><SPAN class=
'rparen'>)</SPAN>
<SPAN class='id identifier rubyid_llm'>llm</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_tracer'>tracer</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='const'><SPAN class='object_link'><A href=
"../../LLM.html" title="LLM (module)">LLM</A></SPAN></SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'><SPAN class='object_link'><A href=
"../Tracer.html" title=
"LLM::Tracer (class)">Tracer</A></SPAN></SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'>Telemetry</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_new'><SPAN class=
'object_link'><A href="#initialize-instance_method" title=
"LLM::Tracer::Telemetry#initialize (method)">new</A></SPAN></SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='id identifier rubyid_llm'>llm</SPAN><SPAN class=
'rparen'>)</SPAN>

<SPAN class='id identifier rubyid_ses'>ses</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='const'><SPAN class='object_link'><A href=
"../../LLM.html" title="LLM (module)">LLM</A></SPAN></SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'><SPAN class='object_link'><A href=
"../Session.html" title=
"LLM::Session (class)">Session</A></SPAN></SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_new'><SPAN class=
'object_link'><A href="../Session.html#initialize-instance_method" title=
"LLM::Session#initialize (method)">new</A></SPAN></SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='id identifier rubyid_llm'>llm</SPAN><SPAN class=
'rparen'>)</SPAN>
<SPAN class='id identifier rubyid_ses'>ses</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_talk'>talk</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class='tstring_content'>hello</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN>
<SPAN class='id identifier rubyid_ses'>ses</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_talk'>talk</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>how are you?</SPAN><SPAN class='tstring_end'>"</SPAN></SPAN>
<SPAN class='id identifier rubyid_ses'>ses</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_tracer'>tracer</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_spans'>spans</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_each'>each</SPAN> <SPAN class=
'lbrace'>{</SPAN> <SPAN class='op'>|</SPAN><SPAN class=
'id identifier rubyid_span'>span</SPAN><SPAN class='op'>|</SPAN> <SPAN class=
'id identifier rubyid_pp'>pp</SPAN> <SPAN class=
'id identifier rubyid_span'>span</SPAN> <SPAN class=
'rbrace'>}</SPAN></CODE></PRE>
          <P class="example_title"></P>
          <DIV class='inline'>
            <P>OTLP export</P>
          </DIV>
          <PRE class="example code"><CODE><SPAN class=
          'comment'>#!/usr/bin/env ruby
</SPAN><SPAN class='id identifier rubyid_require'>require</SPAN> <SPAN class=
'tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>llm</SPAN><SPAN class='tstring_end'>"</SPAN></SPAN>
<SPAN class='id identifier rubyid_require'>require</SPAN> <SPAN class=
'tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>opentelemetry-exporter-otlp</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN>

<SPAN class='id identifier rubyid_endpoint'>endpoint</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>https://api.smith.langchain.com/otel/v1/traces</SPAN><SPAN class='tstring_end'>"</SPAN></SPAN>
<SPAN class='id identifier rubyid_exporter'>exporter</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='const'>OpenTelemetry</SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'>Exporter</SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'>OTLP</SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'>Exporter</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_new'>new</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>endpoint:</SPAN><SPAN class=
'rparen'>)</SPAN>

<SPAN class='id identifier rubyid_llm'>llm</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='const'><SPAN class='object_link'><A href=
"../../LLM.html" title="LLM (module)">LLM</A></SPAN></SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_openai'><SPAN class=
'object_link'><A href="../../LLM.html#openai-class_method" title=
"LLM.openai (method)">openai</A></SPAN></SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>key:</SPAN> <SPAN class=
'const'>ENV</SPAN><SPAN class='lbracket'>[</SPAN><SPAN class=
'tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>KEY</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='rbracket'>]</SPAN><SPAN class=
'rparen'>)</SPAN>
<SPAN class='id identifier rubyid_llm'>llm</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_tracer'>tracer</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='const'><SPAN class='object_link'><A href=
"../../LLM.html" title="LLM (module)">LLM</A></SPAN></SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'><SPAN class='object_link'><A href=
"../Tracer.html" title=
"LLM::Tracer (class)">Tracer</A></SPAN></SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'>Telemetry</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_new'><SPAN class=
'object_link'><A href="#initialize-instance_method" title=
"LLM::Tracer::Telemetry#initialize (method)">new</A></SPAN></SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='id identifier rubyid_llm'>llm</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>exporter:</SPAN><SPAN class=
'rparen'>)</SPAN>

<SPAN class='id identifier rubyid_ses'>ses</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='const'><SPAN class='object_link'><A href=
"../../LLM.html" title="LLM (module)">LLM</A></SPAN></SPAN><SPAN class=
'op'>::</SPAN><SPAN class='const'><SPAN class='object_link'><A href=
"../Session.html" title=
"LLM::Session (class)">Session</A></SPAN></SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_new'><SPAN class=
'object_link'><A href="../Session.html#initialize-instance_method" title=
"LLM::Session#initialize (method)">new</A></SPAN></SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='id identifier rubyid_llm'>llm</SPAN><SPAN class=
'rparen'>)</SPAN>
<SPAN class='id identifier rubyid_ses'>ses</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_talk'>talk</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class='tstring_content'>hello</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN>
<SPAN class='id identifier rubyid_ses'>ses</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_talk'>talk</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>how are you?</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN></CODE></PRE>
        </DIV>
        <P class="tag_title">See Also:</P>
        <UL class="see">
          <LI>
            <A href=
            "https://github.com/open-telemetry/semantic-conventions/blob/main/docs/gen-ai"
            target="_parent" title="Telemetry specs (index)">Telemetry specs
            (index)</A>
          </LI>
          <LI>
            <A href=
            "https://github.com/open-telemetry/semantic-conventions/blob/main/docs/gen-ai/openai.md"
            target="_parent" title="Telemetry specs (OpenAI)">Telemetry specs
            (OpenAI)</A>
          </LI>
        </UL>
      </DIV>
      <H2>Instance Method Summary <SMALL><A href="#" class=
      "summary_toggle">collapse</A></SMALL></H2>
      <UL class="summary">
        <LI class="public">
          <SPAN class="summary_signature"><A href="#flush!-instance_method"
          title="#flush! (instance method)">#<STRONG>flush!</STRONG> ⇒
          nil</A></SPAN>
          <DIV class='inline'>
            <P><SPAN class="summary_desc">Flushes queued telemetry to the
            configured exporter.</SPAN></P>
          </DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href=
          "#on_request_start-instance_method" title=
          "#on_request_start (instance method)">#<STRONG>on_request_start</STRONG>(operation:,
          model: nil) ⇒ Object</A></SPAN>
          <DIV class='inline'></DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href=
          "#on_request_finish-instance_method" title=
          "#on_request_finish (instance method)">#<STRONG>on_request_finish</STRONG>(operation:,
          res:, model: nil, span: nil) ⇒ Object</A></SPAN>
          <DIV class='inline'></DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href=
          "#on_request_error-instance_method" title=
          "#on_request_error (instance method)">#<STRONG>on_request_error</STRONG>(ex:,
          span:) ⇒ Object</A></SPAN>
          <DIV class='inline'></DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href=
          "#on_tool_start-instance_method" title=
          "#on_tool_start (instance method)">#<STRONG>on_tool_start</STRONG>(id:,
          name:, arguments:, model:) ⇒ void</A></SPAN>
          <DIV class='inline'></DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href=
          "#on_tool_finish-instance_method" title=
          "#on_tool_finish (instance method)">#<STRONG>on_tool_finish</STRONG>(result:,
          span:) ⇒ void</A></SPAN>
          <DIV class='inline'></DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href=
          "#on_tool_error-instance_method" title=
          "#on_tool_error (instance method)">#<STRONG>on_tool_error</STRONG>(ex:,
          span:) ⇒ void</A></SPAN>
          <DIV class='inline'></DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href="#spans-instance_method"
          title="#spans (instance method)">#<STRONG>spans</STRONG> ⇒
          Array&lt;OpenTelemetry::SDK::Trace::SpanData&gt;</A></SPAN>
          <DIV class='inline'>
            <P><SPAN class="summary_desc">This method returns an empty array
            for exporters that do not implement 'finished_spans' such as the
            OTLP exporter.</SPAN></P>
          </DIV>
        </LI>
        <LI class="public">
          <SPAN class="summary_signature"><A href="#initialize-instance_method"
          title=
          "#initialize (instance method)">#<STRONG>initialize</STRONG>(provider,
          options = {}) ⇒ LLM::Tracer::Telemetry</A></SPAN> <SPAN class=
          "note title constructor">constructor</SPAN>
          <DIV class='inline'>
            <P><SPAN class="summary_desc">param [LLM::Provider] provider An LLM
            provider.</SPAN></P>
          </DIV>
        </LI>
      </UL>
      <H3 class="inherited">Methods inherited from <SPAN class=
      'object_link'><A href="../Tracer.html" title=
      "LLM::Tracer (class)">LLM::Tracer</A></SPAN></H3>
      <P class="inherited"><SPAN class='object_link'><A href=
      "../Tracer.html#inspect-instance_method" title=
      "LLM::Tracer#inspect (method)">#inspect</A></SPAN></P>
      <DIV id="constructor_details" class="method_details_list">
        <H2>Constructor Details</H2>
        <DIV class="method_details first">
          <H3 class="signature first" id="initialize-instance_method">
          #<STRONG>initialize</STRONG>(provider, options = {}) ⇒
          <TT><SPAN class='object_link'><A href="" title=
          "LLM::Tracer::Telemetry (class)">LLM::Tracer::Telemetry</A></SPAN></TT></H3>
          <DIV class="docstring">
            <DIV class="discussion">
              <P>param [LLM::Provider] provider An LLM provider</P>
            </DIV>
          </DIV>
          <DIV class="tags"></DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


46
47
48
49
50</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 46</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_initialize'>initialize</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class=
'id identifier rubyid_provider'>provider</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class=
'id identifier rubyid_options'>options</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='lbrace'>{</SPAN><SPAN class=
'rbrace'>}</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>super</SPAN>
  <SPAN class='ivar'>@exporter</SPAN> <SPAN class='op'>=</SPAN> <SPAN class=
'id identifier rubyid_options'>options</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_delete'>delete</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='symbol'>:exporter</SPAN><SPAN class=
'rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_setup!'>setup!</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
      </DIV>
      <DIV id="instance_method_details" class="method_details_list">
        <H2>Instance Method Details</H2>
        <DIV class="method_details first">
          <H3 class="signature first" id="flush!-instance_method">
          #<STRONG>flush!</STRONG> ⇒ <TT>nil</TT></H3>
          <DIV class="docstring">
            <DIV class="discussion">
              <DIV class="note notetag">
                <STRONG>Note:</STRONG>
                <DIV class='inline'>
                  <P>Exports are batched in the background by default.
                  Long-lived processes usually do not need to call this method.
                  Short-lived scripts should call <SPAN class=
                  'object_link'><A href="#flush!-instance_method" title=
                  "LLM::Tracer::Telemetry#flush! (method)">#flush!</A></SPAN>
                  before exit to reduce the risk of losing spans that are still
                  buffered.</P>
                </DIV>
              </DIV>
              <P>Flushes queued telemetry to the configured exporter.</P>
            </DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Returns:</P>
            <UL class="return">
              <LI><SPAN class='type'>(<TT>nil</TT>)</SPAN></LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


151
152
153
154</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 151</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_flush!'>flush!</SPAN>
  <SPAN class='ivar'>@tracer_provider</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_force_flush'>force_flush</SPAN>
  <SPAN class='kw'>nil</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
        <DIV class="method_details">
          <H3 class="signature" id="on_request_start-instance_method">
          #<STRONG>on_request_start</STRONG>(operation:, model: nil) ⇒
          <TT><SPAN class='object_link'><A href="../Object.html" title=
          "LLM::Object (class)">Object</A></SPAN></TT></H3>
          <DIV class="docstring">
            <DIV class="discussion"></DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Parameters:</P>
            <UL class="param">
              <LI><SPAN class='name'>operation</SPAN> <SPAN class=
              'type'>(<TT>String</TT>)</SPAN></LI>
              <LI><SPAN class='name'>model</SPAN> <SPAN class=
              'type'>(<TT>String</TT>)</SPAN> <EM class="default">(defaults to:
              <TT>nil</TT>)</EM></LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


54
55
56
57
58
59
60</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 54</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_on_request_start'>on_request_start</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>operation:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>model:</SPAN> <SPAN class=
'kw'>nil</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>case</SPAN> <SPAN class=
'id identifier rubyid_operation'>operation</SPAN>
  <SPAN class='kw'>when</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class='tstring_content'>chat</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='kw'>then</SPAN> <SPAN class=
'id identifier rubyid_start_chat'>start_chat</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>operation:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>model:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>when</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>retrieval</SPAN><SPAN class='tstring_end'>"</SPAN></SPAN> <SPAN class='kw'>then</SPAN> <SPAN class='id identifier rubyid_start_retrieval'>start_retrieval</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='label'>operation:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>else</SPAN> <SPAN class='kw'>nil</SPAN>
  <SPAN class='kw'>end</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
        <DIV class="method_details">
          <H3 class="signature" id="on_request_finish-instance_method">
          #<STRONG>on_request_finish</STRONG>(operation:, res:, model: nil,
          span: nil) ⇒ <TT><SPAN class='object_link'><A href="../Object.html"
          title="LLM::Object (class)">Object</A></SPAN></TT></H3>
          <DIV class="docstring">
            <DIV class="discussion"></DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Parameters:</P>
            <UL class="param">
              <LI><SPAN class='name'>operation</SPAN> <SPAN class=
              'type'>(<TT>String</TT>)</SPAN></LI>
              <LI><SPAN class='name'>model</SPAN> <SPAN class=
              'type'>(<TT>String</TT>)</SPAN> <EM class="default">(defaults to:
              <TT>nil</TT>)</EM></LI>
              <LI><SPAN class='name'>res</SPAN> <SPAN class=
              'type'>(<TT><SPAN class='object_link'><A href="../Response.html"
              title=
              "LLM::Response (class)">LLM::Response</A></SPAN></TT>)</SPAN></LI>
              <LI><SPAN class='name'>span</SPAN> <SPAN class=
              'type'>(<TT><SPAN class='object_link'><A href="../Object.html"
              title="LLM::Object (class)">Object</A></SPAN></TT>,
              <TT>nil</TT>)</SPAN> <EM class="default">(defaults to:
              <TT>nil</TT>)</EM></LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


64
65
66
67
68
69
70
71</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 64</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_on_request_finish'>on_request_finish</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>operation:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>res:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>model:</SPAN> <SPAN class=
'kw'>nil</SPAN><SPAN class='comma'>,</SPAN> <SPAN class=
'label'>span:</SPAN> <SPAN class='kw'>nil</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>return</SPAN> <SPAN class='kw'>nil</SPAN> <SPAN class=
'kw'>unless</SPAN> <SPAN class='id identifier rubyid_span'>span</SPAN>
  <SPAN class='kw'>case</SPAN> <SPAN class=
'id identifier rubyid_operation'>operation</SPAN>
  <SPAN class='kw'>when</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class='tstring_content'>chat</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='kw'>then</SPAN> <SPAN class=
'id identifier rubyid_finish_chat'>finish_chat</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>operation:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>model:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>res:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>span:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>when</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>retrieval</SPAN><SPAN class='tstring_end'>"</SPAN></SPAN> <SPAN class='kw'>then</SPAN> <SPAN class='id identifier rubyid_finish_retrieval'>finish_retrieval</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='label'>operation:</SPAN><SPAN class='comma'>,</SPAN> <SPAN class='label'>res:</SPAN><SPAN class='comma'>,</SPAN> <SPAN class='label'>span:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>else</SPAN> <SPAN class='kw'>nil</SPAN>
  <SPAN class='kw'>end</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
        <DIV class="method_details">
          <H3 class="signature" id="on_request_error-instance_method">
          #<STRONG>on_request_error</STRONG>(ex:, span:) ⇒ <TT><SPAN class=
          'object_link'><A href="../Object.html" title=
          "LLM::Object (class)">Object</A></SPAN></TT></H3>
          <DIV class="docstring">
            <DIV class="discussion"></DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Parameters:</P>
            <UL class="param">
              <LI><SPAN class='name'>ex</SPAN> <SPAN class=
              'type'>(<TT><SPAN class='object_link'><A href="../Error.html"
              title=
              "LLM::Error (class)">LLM::Error</A></SPAN></TT>)</SPAN></LI>
              <LI><SPAN class='name'>span</SPAN> <SPAN class=
              'type'>(<TT><SPAN class='object_link'><A href="../Object.html"
              title="LLM::Object (class)">Object</A></SPAN></TT>,
              <TT>nil</TT>)</SPAN></LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


75
76
77
78
79
80
81
82</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 75</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_on_request_error'>on_request_error</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>ex:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>span:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>return</SPAN> <SPAN class='kw'>nil</SPAN> <SPAN class=
'kw'>unless</SPAN> <SPAN class='id identifier rubyid_span'>span</SPAN>
  <SPAN class='id identifier rubyid_attributes'>attributes</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='lbrace'>{</SPAN><SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>error.type</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_ex'>ex</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_class'>class</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_to_s'>to_s</SPAN><SPAN class='rbrace'>}</SPAN><SPAN class='period'>.</SPAN><SPAN class='id identifier rubyid_compact'>compact</SPAN>
  <SPAN class='id identifier rubyid_attributes'>attributes</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_each'>each</SPAN> <SPAN class=
'lbrace'>{</SPAN> <SPAN class=
'id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_set_attribute'>set_attribute</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='id identifier rubyid__1'>_1</SPAN><SPAN class='comma'>,</SPAN> <SPAN class='id identifier rubyid__2'>_2</SPAN><SPAN class='rparen'>)</SPAN> <SPAN class='rbrace'>}</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_add_event'>add_event</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.request.finish</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_status'>status</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='op'>::</SPAN><SPAN class=
'const'>OpenTelemetry</SPAN><SPAN class='op'>::</SPAN><SPAN class=
'const'>Trace</SPAN><SPAN class='op'>::</SPAN><SPAN class=
'const'>Status</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_error'>error</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='id identifier rubyid_ex'>ex</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_message'>message</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_tap'>tap</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='op'>&</SPAN><SPAN class=
'symbol'>:finish</SPAN><SPAN class='rparen'>)</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
        <DIV class="method_details">
          <H3 class="signature" id="on_tool_start-instance_method">
          #<STRONG>on_tool_start</STRONG>(id:, name:, arguments:, model:) ⇒
          <TT>void</TT></H3>
          <DIV class="docstring">
            <DIV class="discussion">
              <P class="note returns_void">This method returns an undefined
              value.</P>
            </DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Parameters:</P>
            <UL class="param">
              <LI>
                <SPAN class='name'>id</SPAN> <SPAN class=
                'type'>(<TT>String</TT>)</SPAN> —
                <DIV class='inline'>
                  <P>The tool call ID assigned by the model/provider</P>
                </DIV>
              </LI>
              <LI>
                <SPAN class='name'>name</SPAN> <SPAN class=
                'type'>(<TT>String</TT>)</SPAN> —
                <DIV class='inline'>
                  <P>The tool (function) name.</P>
                </DIV>
              </LI>
              <LI>
                <SPAN class='name'>arguments</SPAN> <SPAN class=
                'type'>(<TT>Hash</TT>)</SPAN> —
                <DIV class='inline'>
                  <P>The parsed tool arguments.</P>
                </DIV>
              </LI>
              <LI>
                <SPAN class='name'>model</SPAN> <SPAN class=
                'type'>(<TT>String</TT>)</SPAN> —
                <DIV class='inline'>
                  <P>The model name</P>
                </DIV>
              </LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 87</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_on_tool_start'>on_tool_start</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>id:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>name:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>arguments:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>model:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_attributes'>attributes</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='lbrace'>{</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.operation.name</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>execute_tool</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.request.model</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_model'>model</SPAN><SPAN class='comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.call.id</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_id'>id</SPAN><SPAN class='comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.name</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_name'>name</SPAN><SPAN class='comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.call.arguments</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'const'><SPAN class='object_link'><A href="../../LLM.html" title=
"LLM (module)">LLM</A></SPAN></SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_json'><SPAN class='object_link'><A href=
"../../LLM.html#json-class_method" title=
"LLM.json (method)">json</A></SPAN></SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_dump'>dump</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='id identifier rubyid_arguments'>arguments</SPAN><SPAN class='rparen'>)</SPAN><SPAN class='comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.provider.name</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_provider_name'>provider_name</SPAN><SPAN class=
'comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>server.address</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_provider_host'>provider_host</SPAN><SPAN class=
'comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>server.port</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_provider_port'>provider_port</SPAN>
  <SPAN class='rbrace'>}</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_compact'>compact</SPAN>
  <SPAN class='id identifier rubyid_span_name'>span_name</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='lbracket'>[</SPAN><SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>execute_tool</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='comma'>,</SPAN> <SPAN class=
'id identifier rubyid_name'>name</SPAN><SPAN class=
'rbracket'>]</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_compact'>compact</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_join'>join</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class='tstring_content'> </SPAN><SPAN class='tstring_end'>"</SPAN></SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='ivar'>@tracer</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_start_span'>start_span</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class=
'id identifier rubyid_span_name'>span_name</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_empty?'>empty?</SPAN> <SPAN class=
'op'>?</SPAN> <SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>:</SPAN> <SPAN class=
'id identifier rubyid_span_name'>span_name</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>kind:</SPAN> <SPAN class=
'symbol'>:client</SPAN><SPAN class='comma'>,</SPAN> <SPAN class=
'label'>attributes:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_add_event'>add_event</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.start</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
        <DIV class="method_details">
          <H3 class="signature" id="on_tool_finish-instance_method">
          #<STRONG>on_tool_finish</STRONG>(result:, span:) ⇒ <TT>void</TT></H3>
          <DIV class="docstring">
            <DIV class="discussion">
              <P class="note returns_void">This method returns an undefined
              value.</P>
            </DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Parameters:</P>
            <UL class="param">
              <LI>
                <SPAN class='name'>result</SPAN> <SPAN class=
                'type'>(<TT><SPAN class='object_link'><A href=
                "../Function/Return.html" title=
                "LLM::Function::Return (class)">LLM::Function::Return</A></SPAN></TT>)</SPAN>
                —
                <DIV class='inline'>
                  <P>The tool return object.</P>
                </DIV>
              </LI>
              <LI>
                <SPAN class='name'>span</SPAN> <SPAN class=
                'type'>(<TT><SPAN class='object_link'><A href="../Object.html"
                title="LLM::Object (class)">Object</A></SPAN></TT>,
                <TT>nil</TT>)</SPAN> —
                <DIV class='inline'>
                  <P>The span/context object returned by <SPAN class=
                  'object_link'><A href="#on_tool_start-instance_method" title=
                  "LLM::Tracer::Telemetry#on_tool_start (method)">#on_tool_start</A></SPAN>.</P>
                </DIV>
              </LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


107
108
109
110
111
112
113
114
115
116
117</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 107</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_on_tool_finish'>on_tool_finish</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>result:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>span:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>return</SPAN> <SPAN class='kw'>nil</SPAN> <SPAN class=
'kw'>unless</SPAN> <SPAN class='id identifier rubyid_span'>span</SPAN>
  <SPAN class='id identifier rubyid_attributes'>attributes</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='lbrace'>{</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.call.id</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_result'>result</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_id'>id</SPAN><SPAN class=
'comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.name</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_result'>result</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_name'>name</SPAN><SPAN class='comma'>,</SPAN>
    <SPAN class='tstring'><SPAN class='tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.call.result</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'const'><SPAN class='object_link'><A href="../../LLM.html" title=
"LLM (module)">LLM</A></SPAN></SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_json'><SPAN class='object_link'><A href=
"../../LLM.html#json-class_method" title=
"LLM.json (method)">json</A></SPAN></SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_dump'>dump</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='id identifier rubyid_result'>result</SPAN><SPAN class='period'>.</SPAN><SPAN class='id identifier rubyid_value'>value</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='rbrace'>}</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_compact'>compact</SPAN>
  <SPAN class='id identifier rubyid_attributes'>attributes</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_each'>each</SPAN> <SPAN class=
'lbrace'>{</SPAN> <SPAN class=
'id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_set_attribute'>set_attribute</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='id identifier rubyid__1'>_1</SPAN><SPAN class='comma'>,</SPAN> <SPAN class='id identifier rubyid__2'>_2</SPAN><SPAN class='rparen'>)</SPAN> <SPAN class='rbrace'>}</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_add_event'>add_event</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.finish</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_tap'>tap</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='op'>&</SPAN><SPAN class=
'symbol'>:finish</SPAN><SPAN class='rparen'>)</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
        <DIV class="method_details">
          <H3 class="signature" id="on_tool_error-instance_method">
          #<STRONG>on_tool_error</STRONG>(ex:, span:) ⇒ <TT>void</TT></H3>
          <DIV class="docstring">
            <DIV class="discussion">
              <P class="note returns_void">This method returns an undefined
              value.</P>
            </DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Parameters:</P>
            <UL class="param">
              <LI>
                <SPAN class='name'>ex</SPAN> <SPAN class=
                'type'>(<TT>Exception</TT>)</SPAN> —
                <DIV class='inline'>
                  <P>The raised error.</P>
                </DIV>
              </LI>
              <LI>
                <SPAN class='name'>span</SPAN> <SPAN class=
                'type'>(<TT><SPAN class='object_link'><A href="../Object.html"
                title="LLM::Object (class)">Object</A></SPAN></TT>,
                <TT>nil</TT>)</SPAN> —
                <DIV class='inline'>
                  <P>The span/context object returned by <SPAN class=
                  'object_link'><A href="#on_tool_start-instance_method" title=
                  "LLM::Tracer::Telemetry#on_tool_start (method)">#on_tool_start</A></SPAN>.</P>
                </DIV>
              </LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


122
123
124
125
126
127
128
129</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 122</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_on_tool_error'>on_tool_error</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='label'>ex:</SPAN><SPAN class=
'comma'>,</SPAN> <SPAN class='label'>span:</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='kw'>return</SPAN> <SPAN class='kw'>nil</SPAN> <SPAN class=
'kw'>unless</SPAN> <SPAN class='id identifier rubyid_span'>span</SPAN>
  <SPAN class='id identifier rubyid_attributes'>attributes</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='lbrace'>{</SPAN><SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>error.type</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN> <SPAN class='op'>=&gt;</SPAN> <SPAN class=
'id identifier rubyid_ex'>ex</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_class'>class</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_to_s'>to_s</SPAN><SPAN class='rbrace'>}</SPAN><SPAN class='period'>.</SPAN><SPAN class='id identifier rubyid_compact'>compact</SPAN>
  <SPAN class='id identifier rubyid_attributes'>attributes</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_each'>each</SPAN> <SPAN class=
'lbrace'>{</SPAN> <SPAN class=
'id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_set_attribute'>set_attribute</SPAN><SPAN class='lparen'>(</SPAN><SPAN class='id identifier rubyid__1'>_1</SPAN><SPAN class='comma'>,</SPAN> <SPAN class='id identifier rubyid__2'>_2</SPAN><SPAN class='rparen'>)</SPAN> <SPAN class='rbrace'>}</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_add_event'>add_event</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='tstring'><SPAN class=
'tstring_beg'>"</SPAN><SPAN class=
'tstring_content'>gen_ai.tool.finish</SPAN><SPAN class=
'tstring_end'>"</SPAN></SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_status'>status</SPAN> <SPAN class=
'op'>=</SPAN> <SPAN class='op'>::</SPAN><SPAN class=
'const'>OpenTelemetry</SPAN><SPAN class='op'>::</SPAN><SPAN class=
'const'>Trace</SPAN><SPAN class='op'>::</SPAN><SPAN class=
'const'>Status</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_error'>error</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='id identifier rubyid_ex'>ex</SPAN><SPAN class=
'period'>.</SPAN><SPAN class=
'id identifier rubyid_message'>message</SPAN><SPAN class='rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_span'>span</SPAN><SPAN class=
'period'>.</SPAN><SPAN class='id identifier rubyid_tap'>tap</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='op'>&</SPAN><SPAN class=
'symbol'>:finish</SPAN><SPAN class='rparen'>)</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
        <DIV class="method_details">
          <H3 class="signature" id="spans-instance_method">
          #<STRONG>spans</STRONG> ⇒
          <TT>Array&lt;OpenTelemetry::SDK::Trace::SpanData&gt;</TT></H3>
          <DIV class="docstring">
            <DIV class="discussion">
              <DIV class="note notetag">
                <STRONG>Note:</STRONG>
                <DIV class='inline'></DIV>
              </DIV>
              <P>This method returns an empty array for exporters that do not
              implement 'finished_spans' such as the OTLP exporter</P>
            </DIV>
          </DIV>
          <DIV class="tags">
            <P class="tag_title">Returns:</P>
            <UL class="return">
              <LI><SPAN class=
              'type'>(<TT>Array&lt;OpenTelemetry::SDK::Trace::SpanData&gt;</TT>)</SPAN></LI>
            </UL>
          </DIV>
          <TABLE class="source_code">
            <TR>
              <TD>
                <PRE class="lines">


137
138
139
140
141</PRE>
              </TD>
              <TD>
                <PRE class="code"><SPAN class=
                "info file"># File 'lib/llm/tracer/telemetry.rb', line 137</SPAN>

<SPAN class='kw'>def</SPAN> <SPAN class=
'id identifier rubyid_spans'>spans</SPAN>
  <SPAN class='kw'>return</SPAN> <SPAN class='lbracket'>[</SPAN><SPAN class=
'rbracket'>]</SPAN> <SPAN class='kw'>unless</SPAN> <SPAN class=
'ivar'>@exporter</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_respond_to?'>respond_to?</SPAN><SPAN class=
'lparen'>(</SPAN><SPAN class='symbol'>:finished_spans</SPAN><SPAN class=
'rparen'>)</SPAN>
  <SPAN class='id identifier rubyid_flush!'>flush!</SPAN>
  <SPAN class='ivar'>@exporter</SPAN><SPAN class='period'>.</SPAN><SPAN class=
'id identifier rubyid_finished_spans'>finished_spans</SPAN>
<SPAN class='kw'>end</SPAN></PRE>
              </TD>
            </TR>
          </TABLE>
        </DIV>
      </DIV>
    </DIV>
    <DIV id="footer">
      Generated on Sun Feb 22 12:47:40 2026 by <A href="https://yardoc.org"
      title="Yay! A Ruby Documentation Tool" target="_parent">yard</A> 0.9.36
      (ruby-3.4.5).
    </DIV>
  </DIV>
</BODY>
</HTML>
