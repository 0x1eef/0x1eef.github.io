<!DOCTYPE html>
<HTML lang="en">
<HEAD>
  <META name="generator" content=
  "HTML Tidy for HTML5 for FreeBSD version 5.8.0">
  <TITLE>@0x1eef's personal website</TITLE>
  <META charset="utf-8">
  <META name="viewport" content=
  "width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <LINK rel="icon" sizes="16x16" href="/images/favicon-16x16.png">
  <LINK rel="icon" sizes="32x32" href="/images/favicon-32x32.png">
  <LINK rel="icon" sizes="48x48" href="/images/favicon-48x48.png">
  <LINK rel="icon" sizes="64x64" href="/images/favicon-64x64.png">
  <LINK rel="icon" sizes="128x128" href="/images/favicon-128x128.png">
  <LINK rel="icon" sizes="256x256" href="/images/favicon-256x256.png">
  <LINK rel="stylesheet" href="/css/main.css">
  <SCRIPT src="/js/prism.js" async></SCRIPT>
  <LINK rel="stylesheet" href="/css/prism/github.css">
  <LINK rel="stylesheet" href="/css/prism/tomorrownight.css">
  <META property="og:type" content="article">
  <META property="og:title" content=
  "How to improve FireFox's file dialog on OpenBSD">
  <META property="og:description" content=
  "Documents how to improve FireFox's file dialog on OpenBSD">
  <META property="og:url" content=
  "https://0x1eef.github.io/posts/improve-firefox-file-dialog-on-openbsd">
  <META property="og:image" content="https://0x1eef.github.io/images/og.png">
  <META property="og:image:type" content="image/png">
  <META property="og:image:width" content="512">
  <META property="og:image:height" content="512">
</HEAD>
<BODY class="hidden">
  <HEADER class="main-header">
    <IMG src="/images/og.png" alt="Leaf Logo" class="nav-logo">
    <NAV>
      <UL>
        <LI>
          <A href="/">HOME</A>
        </LI>
        <LI>
          <A href="/posts">POSTS</A>
        </LI>
      </UL>
    </NAV><BUTTON id="theme-toggle" aria-label="Toggle dark mode"><SPAN class=
    "theme-icon-sun" aria-hidden="true">â˜€</SPAN> <SPAN class="theme-icon-moon"
    aria-hidden="true">ðŸŒ™</SPAN></BUTTON>
  </HEADER>
  <MAIN>
    <DIV>
      <H2>About</H2>
      <P>This post shares how I have optimized the Firefox file dialog that is
      common for both file uploads and downloads on OpenBSD.</P>
      <H2>Background</H2>
      <P>OpenBSD secures Firefox and Chromium through its <A href=
      "https://man.openbsd.org/unveil">unveil(2)</A> feature. As a result, each
      Firefox process is limited to accessing a select number of files and
      directories. For the average joe and jane, it means both
      <CODE>~/Downloads</CODE> and <CODE>/tmp</CODE> are available for file
      downloads and uploads by default, and the rest of the filesystem remains
      off-limits.</P>
      <P>The files referenced by <CODE>/etc/firefox/unveil.*</CODE> provide a
      complete list of the files and directories available to each Firefox
      process. The files can be edited to further restrict or expand filesystem
      access, and afterwards Firefox should be restarted for the changes to
      take effect.</P>
      <P>Although <A href="https://man.openbsd.org/unveil">unveil(2)</A>
      happens to be one of the reasons I choose to use OpenBSD on the desktop,
      the file dialog that is available for selecting a file can be difficult
      to use because it assumes the entire filesystem is accessible and that's
      not the case 0on OpenBSD.</P>
      <H2>Bookmarks</H2>
      <P>Thankfully â€“ the file dialog can be improved by pinning file locations
      we know <A href="https://man.openbsd.org/unveil">unveil(2)</A> allows
      access to. This can be done by editing the <CODE>bookmarks</CODE> file
      used by GTK file dialogs to show pinned file locations. This file can be
      found at <CODE>${HOME}/.config/gtk-3.0/bookmarks</CODE>.</P>
      <P><STRONG>Context</STRONG><BR>
      The following command displays the contents of the _firefox user's
      <CODE>bookmarks</CODE> file. Note that the _firefox user runs Firefox on
      my system; this might not be the case for you. The file includes two
      entries: the user's default downloads directory and a custom directory
      (<CODE>Extensions</CODE>) manually added to
      <CODE>/etc/firefox/unveil.{main,content}</CODE>.</P>
      <PRE><CODE class=
      "language-sh">main@localhost$ cat /home/_firefox/.config/gtk-3.0/bookmarks
file:///home/_firefox/Downloads Downloads
file:///mnt/browser-extensions Extensions
</CODE></PRE><BR>
      <P><STRONG>Explanation</STRONG><BR></P>
      <UL>
        <LI>file:///home/_firefox/Downloads Downloads<BR>
        This line pins the default <CODE>Downloads</CODE> directory, which is
        accessible to Firefox processes by default.</LI>
        <LI>file:///mnt/browser-extensions Extensions<BR>
        This line pins a custom <CODE>Extensions</CODE> directory. For this
        entry to be effective, the <CODE>/mnt/browser-extensions</CODE> path
        must be explicitly added to the <CODE>unveil(2)</CODE> rules for
        Firefox processes (eg: in
        <CODE>/etc/firefox/unveil.{main,content}</CODE>).</LI>
      </UL>
      <H2>Conclusion</H2>
      <P><STRONG>Context</STRONG><BR></P>
      <P>With the <CODE>bookmarks</CODE> file configured, and Firefox
      restarted, the Firefox file dialog should now display the specified
      locations as easily navigable, pinned entries, as shown in the
      screenshot. This resolves the minor but recurring frustration of not
      having a straightforward way to access desired file locations within
      Firefox on OpenBSD.</P>
      <P><STRONG>Demo</STRONG> <A target="_blank" href=
      "filedialog.png"><IMG src="filedialog.png" alt="file dialog"></A></P>
    </DIV>
  </MAIN>
  <FOOTER>
    <P>This website was generated by <A href="https://go.dev/" target="_blank"
    rel="noopener noreferrer">Golang</A></P>
  </FOOTER>
  <SCRIPT src="/js/main.js"></SCRIPT>
</BODY>
</HTML>
